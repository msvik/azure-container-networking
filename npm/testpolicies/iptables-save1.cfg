# Generated by iptables-save v1.6.1 on Tue Mar 16 16:37:00 2021
*filter
:INPUT ACCEPT [378132:31045760]
:FORWARD ACCEPT [12956:1171335]
:OUTPUT ACCEPT [382350:34033399]
:AZURE-NPM - [0:0]
:AZURE-NPM-EGRESS - [0:0]
:AZURE-NPM-EGRESS-DROPS - [0:0]
:AZURE-NPM-EGRESS-PORT - [0:0]
:AZURE-NPM-EGRESS-TO - [0:0]
:AZURE-NPM-INGRESS - [0:0]
:AZURE-NPM-INGRESS-FROM - [0:0]
:AZURE-NPM-INGRESS-PORT - [0:0]
:AZURE-NPM-INRGESS-DROPS - [0:0]
:AZURE-NPM-TARGET-SETS - [0:0]
:DOCKER - [0:0]
:DOCKER-ISOLATION-STAGE-1 - [0:0]
:DOCKER-ISOLATION-STAGE-2 - [0:0]
:DOCKER-USER - [0:0]
:KUBE-EXTERNAL-SERVICES - [0:0]
:KUBE-FIREWALL - [0:0]
:KUBE-FORWARD - [0:0]
:KUBE-KUBELET-CANARY - [0:0]
:KUBE-PROXY-CANARY - [0:0]
:KUBE-SERVICES - [0:0]
-A INPUT -m conntrack --ctstate NEW -m comment --comment "kubernetes service portals" -j KUBE-SERVICES
-A INPUT -m conntrack --ctstate NEW -m comment --comment "kubernetes externally-visible service portals" -j KUBE-EXTERNAL-SERVICES
-A INPUT -j KUBE-FIREWALL
-A FORWARD -m comment --comment "kubernetes forwarding rules" -j KUBE-FORWARD
-A FORWARD -m conntrack --ctstate NEW -m comment --comment "kubernetes service portals" -j KUBE-SERVICES
-A FORWARD -j AZURE-NPM
-A FORWARD -d 168.63.129.16/32 -p tcp -m tcp --dport 80 -j DROP
-A FORWARD -j DOCKER-USER
-A FORWARD -j DOCKER-ISOLATION-STAGE-1
-A FORWARD -o docker0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -o docker0 -j DOCKER
-A FORWARD -i docker0 ! -o docker0 -j ACCEPT
-A FORWARD -i docker0 -o docker0 -j ACCEPT
-A OUTPUT -m conntrack --ctstate NEW -m comment --comment "kubernetes service portals" -j KUBE-SERVICES
-A OUTPUT -j KUBE-FIREWALL
-A AZURE-NPM -j AZURE-NPM-INGRESS
-A AZURE-NPM -j AZURE-NPM-EGRESS
-A AZURE-NPM -m mark --mark 0x3000 -m comment --comment ACCEPT-on-INGRESS-and-EGRESS-mark-0x3000 -j ACCEPT
-A AZURE-NPM -m mark --mark 0x2000 -m comment --comment ACCEPT-on-INGRESS-mark-0x2000 -j ACCEPT
-A AZURE-NPM -m mark --mark 0x1000 -m comment --comment ACCEPT-on-EGRESS-mark-0x1000 -j ACCEPT
-A AZURE-NPM -m state --state RELATED,ESTABLISHED -m comment --comment ACCEPT-on-connection-state -j ACCEPT
-A AZURE-NPM-EGRESS -j AZURE-NPM-EGRESS-PORT
-A AZURE-NPM-EGRESS -m mark --mark 0x3000 -m comment --comment RETURN-on-EGRESS-and-INGRESS-mark-0x3000 -j RETURN
-A AZURE-NPM-EGRESS -m mark --mark 0x1000 -m comment --comment RETURN-on-EGRESS-mark-0x1000 -j RETURN
-A AZURE-NPM-EGRESS -j AZURE-NPM-EGRESS-DROPS
-A AZURE-NPM-EGRESS-DROPS -m set --match-set azure-npm-2644416949 src -m set --match-set azure-npm-2637894527 src -m comment --comment "DROP-ALL-FROM-app:gw-ca-IN-ns-ca" -j DROP
-A AZURE-NPM-EGRESS-DROPS -m set --match-set azure-npm-2644416949 src -m comment --comment DROP-ALL-FROM-ns-ca -j DROP
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-993842111 dst -m tcp --dport 8090 -m set --match-set azure-npm-2644416949 src -m set --match-set azure-npm-2637894527 src -m comment --comment "ALLOW-ns-networking/namespace:th-lado-b-AND-TCP-PORT-8090-FROM-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-1010619730 dst -m tcp --dport 8090 -m set --match-set azure-npm-2644416949 src -m set --match-set azure-npm-2637894527 src -m comment --comment "ALLOW-ns-networking/namespace:th-lado-a-AND-TCP-PORT-8090-FROM-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m tcp --dport 443 -m set --match-set azure-npm-2644416949 src -m set --match-set azure-npm-2637894527 src -m set --match-set azure-npm-2668037514 dst -m comment --comment "ALLOW-gw-dc-int-in-ns-ca-3out-AND-TCP-PORT-443-FROM-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m tcp --dport 8443 -m set --match-set azure-npm-2644416949 src -m set --match-set azure-npm-2637894527 src -m set --match-set azure-npm-3117414675 dst -m comment --comment "ALLOW-gw-dc-int-in-ns-ca-2out-AND-TCP-PORT-8443-FROM-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m tcp --dport 443 -m set --match-set azure-npm-2644416949 src -m set --match-set azure-npm-2637894527 src -m set --match-set azure-npm-3117414675 dst -m comment --comment "ALLOW-gw-dc-int-in-ns-ca-2out-AND-TCP-PORT-443-FROM-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m tcp --dport 3306 -m set --match-set azure-npm-2644416949 src -m set --match-set azure-npm-2637894527 src -m set --match-set azure-npm-2622855973 dst -m comment --comment "ALLOW-gw-dc-int-in-ns-ca-0out-AND-TCP-PORT-3306-FROM-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-3898567500 dst -m tcp --dport 9994 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:linkerd-AND-TCP-PORT-9994-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-3898567500 dst -m tcp --dport 8084 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:linkerd-AND-TCP-PORT-8084-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-3898567500 dst -m tcp --dport 443 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:linkerd-AND-TCP-PORT-443-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-3898567500 dst -m tcp --dport 8088 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:linkerd-AND-TCP-PORT-8088-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-3898567500 dst -m tcp --dport 443 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:linkerd-AND-TCP-PORT-443-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-3898567500 dst -m tcp --dport 9090 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:linkerd-AND-TCP-PORT-9090-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-3898567500 dst -m tcp --dport 8080 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:linkerd-AND-TCP-PORT-8080-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-3898567500 dst -m tcp --dport 3000 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:linkerd-AND-TCP-PORT-3000-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-3898567500 dst -m tcp --dport 8086 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:linkerd-AND-TCP-PORT-8086-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-3898567500 dst -m tcp --dport 8085 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:linkerd-AND-TCP-PORT-8085-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-686617452 dst -m tcp --dport 44134 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:kube-system-AND-TCP-PORT-44134-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-686617452 dst -m tcp --dport 443 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:kube-system-AND-TCP-PORT-443-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-686617452 dst -m tcp --dport 80 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:kube-system-AND-TCP-PORT-80-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-686617452 dst -m tcp --dport 25227 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:kube-system-AND-TCP-PORT-25227-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p udp -m set --match-set azure-npm-686617452 dst -m udp --dport 53 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:kube-system-AND-UDP-PORT-53-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -p tcp -m set --match-set azure-npm-686617452 dst -m tcp --dport 53 -m set --match-set azure-npm-2644416949 src -m comment --comment "ALLOW-ns-networking/namespace:kube-system-AND-TCP-PORT-53-FROM-ns-ca" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -m set --match-set azure-npm-2064349730 src -m set --match-set azure-npm-826519261 src -m comment --comment "ALLOW-ALL-FROM-app:konnectivity-agent-IN-ns-kube-system" -j MARK --set-xmark 0x1000/0x1000
-A AZURE-NPM-EGRESS-PORT -m mark --mark 0x3000 -m comment --comment RETURN-on-EGRESS-and-INGRESS-mark-0x3000 -j RETURN
-A AZURE-NPM-EGRESS-PORT -m mark --mark 0x1000 -m comment --comment RETURN-on-EGRESS-mark-0x1000 -j RETURN
-A AZURE-NPM-EGRESS-PORT -m set --match-set azure-npm-2064349730 src -m set --match-set azure-npm-826519261 src -m comment --comment "ALLOW-ALL-FROM-app:konnectivity-agent-IN-ns-kube-system-TO-JUMP-TO-AZURE-NPM-EGRESS-DROPS" -j AZURE-NPM-EGRESS-DROPS
-A AZURE-NPM-EGRESS-PORT -m set --match-set azure-npm-2644416949 src -m comment --comment ALLOW-ALL-FROM-ns-ca-TO-JUMP-TO-AZURE-NPM-EGRESS-DROPS -j AZURE-NPM-EGRESS-DROPS
-A AZURE-NPM-EGRESS-PORT -m set --match-set azure-npm-2644416949 src -m set --match-set azure-npm-2637894527 src -m comment --comment "ALLOW-ALL-FROM-app:gw-ca-IN-ns-ca-TO-JUMP-TO-AZURE-NPM-EGRESS-DROPS" -j AZURE-NPM-EGRESS-DROPS
-A AZURE-NPM-EGRESS-TO -m mark --mark 0x3000 -m comment --comment RETURN-on-EGRESS-and-INGRESS-mark-0x3000 -j RETURN
-A AZURE-NPM-EGRESS-TO -m mark --mark 0x1000 -m comment --comment RETURN-on-EGRESS-mark-0x1000 -j RETURN
-A AZURE-NPM-INGRESS -j AZURE-NPM-INGRESS-PORT
-A AZURE-NPM-INGRESS -m mark --mark 0x2000 -m comment --comment RETURN-on-INGRESS-mark-0x2000 -j RETURN
-A AZURE-NPM-INGRESS -j AZURE-NPM-INRGESS-DROPS
-A AZURE-NPM-INGRESS-FROM -m set --match-set azure-npm-3898567500 src -m set --match-set azure-npm-2644416949 dst -m comment --comment "ALLOW-ns-networking/namespace:linkerd-TO-ns-ca" -j MARK --set-xmark 0x2000/0xffffffff
-A AZURE-NPM-INGRESS-FROM -m mark --mark 0x2000 -m comment --comment RETURN-on-INGRESS-mark-0x2000 -j RETURN
-A AZURE-NPM-INGRESS-FROM -m set --match-set azure-npm-2644416949 dst -m comment --comment ALLOW-ALL-TO-ns-ca-TO-JUMP-TO-AZURE-NPM-INRGESS-DROPS -j AZURE-NPM-INRGESS-DROPS
-A AZURE-NPM-INGRESS-PORT -p tcp -m set --match-set azure-npm-2644416949 dst -m set --match-set azure-npm-2637894527 dst -m set --match-set azure-npm-993842111 src -m tcp --dport 8443 -m comment --comment "ALLOW-ns-networking/namespace:th-lado-b-AND-TCP-PORT-8443-TO-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x2000/0xffffffff
-A AZURE-NPM-INGRESS-PORT -p tcp -m set --match-set azure-npm-2644416949 dst -m set --match-set azure-npm-2637894527 dst -m set --match-set azure-npm-993842111 src -m tcp --dport 443 -m comment --comment "ALLOW-ns-networking/namespace:th-lado-b-AND-TCP-PORT-443-TO-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x2000/0xffffffff
-A AZURE-NPM-INGRESS-PORT -p tcp -m set --match-set azure-npm-2644416949 dst -m set --match-set azure-npm-2637894527 dst -m set --match-set azure-npm-1010619730 src -m tcp --dport 8443 -m comment --comment "ALLOW-ns-networking/namespace:th-lado-a-AND-TCP-PORT-8443-TO-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x2000/0xffffffff
-A AZURE-NPM-INGRESS-PORT -p tcp -m set --match-set azure-npm-2644416949 dst -m set --match-set azure-npm-2637894527 dst -m set --match-set azure-npm-1010619730 src -m tcp --dport 443 -m comment --comment "ALLOW-ns-networking/namespace:th-lado-a-AND-TCP-PORT-443-TO-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x2000/0xffffffff
-A AZURE-NPM-INGRESS-PORT -p tcp -m set --match-set azure-npm-2644416949 dst -m set --match-set azure-npm-2637894527 dst -m set --match-set azure-npm-649155199 src -m tcp --dport 9443 -m comment --comment "ALLOW-gw-dc-int-in-ns-ca-1in-AND-TCP-PORT-9443-TO-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x2000/0xffffffff
-A AZURE-NPM-INGRESS-PORT -p tcp -m set --match-set azure-npm-2644416949 dst -m set --match-set azure-npm-2637894527 dst -m set --match-set azure-npm-649155199 src -m tcp --dport 7443 -m comment --comment "ALLOW-gw-dc-int-in-ns-ca-1in-AND-TCP-PORT-7443-TO-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x2000/0xffffffff
-A AZURE-NPM-INGRESS-PORT -p tcp -m set --match-set azure-npm-2644416949 dst -m set --match-set azure-npm-2637894527 dst -m set --match-set azure-npm-2442279648 src -m tcp --dport 8443 -m comment --comment "ALLOW-gw-dc-int-in-ns-ca-0in-AND-TCP-PORT-8443-TO-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x2000/0xffffffff
-A AZURE-NPM-INGRESS-PORT -p tcp -m set --match-set azure-npm-2644416949 dst -m set --match-set azure-npm-2637894527 dst -m set --match-set azure-npm-2442279648 src -m tcp --dport 443 -m comment --comment "ALLOW-gw-dc-int-in-ns-ca-0in-AND-TCP-PORT-443-TO-app:gw-ca-IN-ns-ca" -j MARK --set-xmark 0x2000/0xffffffff
-A AZURE-NPM-INGRESS-PORT -m mark --mark 0x2000 -m comment --comment RETURN-on-INGRESS-mark-0x2000 -j RETURN
-A AZURE-NPM-INGRESS-PORT -m set --match-set azure-npm-2644416949 dst -m comment --comment ALLOW-ALL-TO-ns-ca-TO-JUMP-TO-AZURE-NPM-INGRESS-FROM -j AZURE-NPM-INGRESS-FROM
-A AZURE-NPM-INGRESS-PORT -m set --match-set azure-npm-2644416949 dst -m set --match-set azure-npm-2637894527 dst -m comment --comment "ALLOW-ALL-TO-app:gw-ca-IN-ns-ca-TO-JUMP-TO-AZURE-NPM-INRGESS-DROPS" -j AZURE-NPM-INRGESS-DROPS
-A AZURE-NPM-INRGESS-DROPS -m set --match-set azure-npm-2644416949 dst -m set --match-set azure-npm-2637894527 dst -m comment --comment "DROP-ALL-TO-app:gw-ca-IN-ns-ca" -j DROP
-A AZURE-NPM-INRGESS-DROPS -m set --match-set azure-npm-2644416949 dst -m comment --comment DROP-ALL-TO-ns-ca -j DROP
-A AZURE-NPM-TARGET-SETS -m set --match-set azure-npm-2644416949 src -m set --match-set azure-npm-2637894527 src -m comment --comment "DROP-ALL-FROM-app:gw-ca-IN-ns-ca" -j DROP
-A AZURE-NPM-TARGET-SETS -m set --match-set azure-npm-2644416949 dst -m set --match-set azure-npm-2637894527 dst -m comment --comment "DROP-ALL-TO-app:gw-ca-IN-ns-ca" -j DROP
-A AZURE-NPM-TARGET-SETS -m set --match-set azure-npm-2644416949 src -m comment --comment DROP-ALL-FROM-ns-ca -j DROP
-A AZURE-NPM-TARGET-SETS -m set --match-set azure-npm-2644416949 dst -m comment --comment DROP-ALL-TO-ns-ca -j DROP
-A DOCKER-ISOLATION-STAGE-1 -i docker0 ! -o docker0 -j DOCKER-ISOLATION-STAGE-2
-A DOCKER-ISOLATION-STAGE-1 -j RETURN
-A DOCKER-ISOLATION-STAGE-2 -o docker0 -j DROP
-A DOCKER-ISOLATION-STAGE-2 -j RETURN
-A DOCKER-USER -j RETURN
-A KUBE-FIREWALL -m comment --comment "kubernetes firewall for dropping marked packets" -m mark --mark 0x8000/0x8000 -j DROP
-A KUBE-FIREWALL ! -s 127.0.0.0/8 -d 127.0.0.0/8 -m comment --comment "block incoming localnet connections" -m conntrack ! --ctstate RELATED,ESTABLISHED,DNAT -j DROP
-A KUBE-FORWARD -m conntrack --ctstate INVALID -j DROP
-A KUBE-FORWARD -m comment --comment "kubernetes forwarding rules" -m mark --mark 0x4000/0x4000 -j ACCEPT
-A KUBE-FORWARD -m comment --comment "kubernetes forwarding conntrack pod source rule" -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A KUBE-FORWARD -m comment --comment "kubernetes forwarding conntrack pod destination rule" -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
COMMIT
# Completed on Tue Mar 16 16:37:00 2021